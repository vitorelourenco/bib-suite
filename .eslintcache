[{"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/FSConfig.js":"1","/home/vitor/Desktop/personal/km_tag/src/components/ImagePanel/ImagePanel.js":"2","/home/vitor/Desktop/personal/km_tag/src/App.js":"3","/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/PicturesList/TagRow.js":"4","/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/PicturesList/PicturesList.js":"5","/home/vitor/Desktop/personal/km_tag/src/index.js":"6","/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/ConfirmationModal.js":"7","/home/vitor/Desktop/personal/km_tag/src/helper_functions/fileHandling.js":"8","/home/vitor/Desktop/personal/km_tag/src/components/Button.js":"9","/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/TagsPanel.js":"10","/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/BibInput.js":"11","/home/vitor/Desktop/personal/km_tag/src/styles/GlobalStyles.js":"12","/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/BibList.js":"13","/home/vitor/Desktop/personal/km_tag/src/contexts/CurrentImage.js":"14","/home/vitor/Desktop/personal/km_tag/src/contexts/Images.js":"15","/home/vitor/Desktop/personal/km_tag/src/defaultGaleries.js":"16","/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/GalleriesModal.js":"17"},{"size":5955,"mtime":1625700010510,"results":"18","hashOfConfig":"19"},{"size":1846,"mtime":1625596660475,"results":"20","hashOfConfig":"19"},{"size":1888,"mtime":1625677054734,"results":"21","hashOfConfig":"19"},{"size":1303,"mtime":1625607870828,"results":"22","hashOfConfig":"19"},{"size":2165,"mtime":1625667873866,"results":"23","hashOfConfig":"19"},{"size":262,"mtime":1612026608000,"results":"24","hashOfConfig":"19"},{"size":2121,"mtime":1625686256571,"results":"25","hashOfConfig":"19"},{"size":1725,"mtime":1625687228080,"results":"26","hashOfConfig":"19"},{"size":2355,"mtime":1625500038121,"results":"27","hashOfConfig":"19"},{"size":2789,"mtime":1625686230527,"results":"28","hashOfConfig":"19"},{"size":5983,"mtime":1625710389492,"results":"29","hashOfConfig":"19"},{"size":1505,"mtime":1625513904733,"results":"30","hashOfConfig":"19"},{"size":1337,"mtime":1625675927617,"results":"31","hashOfConfig":"19"},{"size":107,"mtime":1625416480487,"results":"32","hashOfConfig":"19"},{"size":95,"mtime":1625415957765,"results":"33","hashOfConfig":"19"},{"size":5839,"mtime":1625702981786,"results":"34","hashOfConfig":"19"},{"size":5753,"mtime":1625709209542,"results":"35","hashOfConfig":"19"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"38"},"1a7xt18",{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"41","messages":"42","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"43"},{"filePath":"44","messages":"45","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"46","usedDeprecatedRules":"47"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"51","messages":"52","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"53","messages":"54","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"43"},{"filePath":"55","messages":"56","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"43"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"59"},{"filePath":"60","messages":"61","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"62","messages":"63","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"64"},{"filePath":"65","messages":"66","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"67","messages":"68","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"69","messages":"70","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"71"},{"filePath":"72","messages":"73","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"74","messages":"75","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"76","messages":"77","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/FSConfig.js",["78","79"],"import { Button, LeftButton, RightButton } from '../Button';\nimport { getDirAsync, saveFilePathAsync, getJPEGsFromFolder, getCSVPathAsync, bareCSVfile} from '../../helper_functions/fileHandling';\nimport { useContext, useState, useEffect} from 'react';\nimport Images from '../../contexts/Images';\nimport styled from 'styled-components';\nimport CurrentImage from '../../contexts/CurrentImage';\nimport GalleriesModal from './GalleriesModal';\n\nconst fs = window.require('fs');\nconst pathModule = window.require('path')\n\nconst jpgRegExp = new RegExp(/(.jpg$)|(.JPG$)|(.jpeg$)|(.JPEG$)/);\n\nexport default function FSConfig({setPicturesList, setCSVFile, CSVFile, saveToFile}){\n  const {lowResImages, setLowResImages, setHighResImages, tags, setTags} = useContext(Images);\n  const {setCurrentImage, setCurrentIndex} = useContext(CurrentImage);\n\n  const [isHidden, setIsHidden] = useState(false);\n  \n  const [srcDir, setSrcDir] = useState(\"\");\n  const [highResDir, setHighResDir] = useState(\"\");\n  const [inputCount, setInputCount] = useState(0);\n  const [showGalleries, setShowGalleries] = useState(false);\n\n  useEffect(()=>{\n    const lowResPaths = getJPEGsFromFolder(srcDir);\n    if (srcDir!==\"\" && lowResPaths?.length < 1) {\n      setSrcDir(\"\");\n      alert(`No jpg-like images in ${srcDir}`);\n      return;\n    }\n    const lowResImages = {};\n    lowResPaths.forEach(path=>{\n      const fullName = pathModule.basename(path);\n      const name = fullName.replace(jpgRegExp, \"\");\n      lowResImages[name] = path;\n    })\n    setLowResImages(lowResImages);\n  },[srcDir]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(()=>{\n    const highResPaths = getJPEGsFromFolder(highResDir);\n    if (highResDir!==\"\" && highResPaths?.length < 1) {\n      setHighResDir(\"\");\n      alert(`No jpg-like images in ${highResDir}`);\n      return;\n    }\n    const highResImages = {};\n    highResPaths.forEach(path=>{\n      const fullName = pathModule.basename(path);\n      const name = fullName.replace(jpgRegExp, \"\");\n      highResImages[name] = path;    \n    });\n    setHighResImages(highResImages);\n  },[highResDir]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  //loadcsv\n  useEffect(()=>{\n    const picturesList = [];\n    const csvImages = {};\n    try {\n      const buf = fs.readFileSync(CSVFile);\n      const csvStr = buf.toString().split(\"\\r\\n\");\n      if (csvStr.length < 1){\n        alert(\"Empty CSV\");\n        return;\n      }\n      for (let i=0; i< csvStr.length; i++){\n        const cells = csvStr[i].split(\";\")\n        if (cells[0] === \"\") continue;\n        const cellsSlice = cells.slice(1,);\n        const filteredCells = cellsSlice.filter(elem=>elem!==\"\");\n        csvImages[cells[0]] = filteredCells;\n        picturesList.push(cells[0]);\n      }\n      setTags(csvImages);\n      setPicturesList(picturesList);\n      setCurrentImage(picturesList[0]);\n      setCurrentIndex(0);\n      setInputCount(0);\n    } catch (err) {\n      console.log(err);\n      console.log(\"err at load csv\")\n    }\n  },[CSVFile]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(()=>{\n    setInputCount(inputCount+1);\n  },[tags])\n\n  useEffect(()=>{\n    if (!fs.existsSync(CSVFile)) return;\n    if (inputCount > 100){\n      saveToFile(CSVFile+\"shadowcopy\");\n      saveToFile(CSVFile+\"autobackup\");\n      fs.unlinkSync(CSVFile+\"shadowcopy\");\n      setInputCount(0);\n    }\n  },[inputCount])\n\n  console.log(showGalleries);\n  return (\n    <TopWrapper isHidden={isHidden}>\n        <Button\n          className=\"FSOptions--lowResDir-set\"\n          variant=\"primary\"\n          onClick={() => getDirAsync().then(dir=>{if(dir) setSrcDir(dir)})}\n        >\n          Set <strong>low res</strong> jpg dir\n        </Button>\n        <h4 className=\"FSOptions--lowResDir-show\">{srcDir}</h4>\n\n        <Button\n          className=\"FSOptions--highResDir\"\n          disabled={srcDir?false:true}\n          variant=\"primary\"\n          onClick={() => getDirAsync().then(dir=>{if(dir) setHighResDir(dir)})}\n        >\n          Set <strong>high res</strong> jpg dir\n        </Button>\n        <h4>{highResDir}</h4>\n\n        <LeftButton\n          variant=\"primary\"\n          disabled={srcDir?false:true}\n          onClick={() =>{\n            getCSVPathAsync()\n            .then(file=>{\n              if (!file) return;\n              if (file === CSVFile) return alert(\"Can't load the same file\");\n              setCSVFile(file);\n              document.querySelector(\"#input-box\").focus();\n            });\n          }}\n        >\n          <strong>Load</strong> csv\n        </LeftButton>\n        <RightButton\n          disabled={srcDir?false:true}\n          variant=\"primary\"\n          onClick={() => {\n            saveFilePathAsync()\n            .then(file=>{\n              if (!file) return;\n              if (file === CSVFile) return alert(\"Can't overwrite the same file\");\n              bareCSVfile(file, lowResImages);\n              setCSVFile(file);\n              document.querySelector(\"#input-box\").focus();\n            });\n          }}\n        >\n          New <strong>bare</strong> csv\n        </RightButton>\n        <h4>{CSVFile}</h4>\n\n        <Button\n          variant=\"primary\"\n          onClick={()=>setShowGalleries(true)}\n        >\n          Galleries\n        </Button>\n\n        <Button\n          className=\"always-show\"\n          variant={isHidden ? \"include\" : \"ditch\"}\n          onClick={() =>\n            setIsHidden(!isHidden)\n          }\n        >\n          {isHidden ? \"Show FS Options\" : \"Hide FS Options\"}\n        </Button>\n        {showGalleries ? (\n          <GalleriesModal\n            setShowGalleries={setShowGalleries}\n          />\n          ) : (\n            ''\n        )}\n      </TopWrapper>\n  )\n}\n\nconst TopWrapper = styled.div`\n  border-radius: 6px;\n  margin-bottom: 10px;\n  box-shadow: 0 0 3px rgba(0,0,0, 0.5);\n  background-color: #eee;\n  button, h4{\n    display: ${props=>props.isHidden ? \"none\" : \"\"};\n  }\n\n  .always-show{\n    display: block;\n  }\n`;","/home/vitor/Desktop/personal/km_tag/src/components/ImagePanel/ImagePanel.js",[],"/home/vitor/Desktop/personal/km_tag/src/App.js",[],["80","81"],"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/PicturesList/TagRow.js",["82"],"import styled from 'styled-components'\nimport React, { useRef } from 'react'\n\nfunction TagRow(props) {\n  const {setCurrentImage, setCurrentIndex, isCurrentImage, tagsOfPicture, picture, picturesList, tagsString} = props;\n  const ref = useRef(null)\n\n  return (\n    <TopWrapper\n      className={isCurrentImage ? 'current' : 'other'}\n      id={picture}\n      onClick={() => {\n        const image = ref?.current?.textContent\n        if (image) {\n          setCurrentImage(image);\n          setCurrentIndex(picturesList.indexOf(picture));\n        }\n      }}\n    >\n      <p ref={ref} className=\"left\">\n        {picture}\n      </p>\n      <p className=\"right\">{tagsOfPicture?.join(\";\")}</p>\n    </TopWrapper>\n  )\n}\n\nconst MemoizedTagRow = React.memo(TagRow, (prevProps, nextProps)=>{\n  if (prevProps.isCurrentImage !== nextProps.isCurrentImage) return false;\n  if (prevProps.tagsString !== nextProps.tagsString) return false;\n  return true;\n});\n\nexport default MemoizedTagRow;\n\nconst TopWrapper = styled.li`\n  display: grid;\n  grid-template-columns: 18ch 1fr;\n  border-bottom: 1px solid #333;\n  cursor: pointer;\n\n  &.current {\n    background-color: green !important;\n    outline: 1px solid orange;\n  }\n\n  .left {\n    border-right: 1px solid #333;\n  }\n\n  p {\n    word-break: break-all;\n    padding: 0.5ch;\n  }\n`\n",["83","84"],"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/PicturesList/PicturesList.js",[],["85","86"],"/home/vitor/Desktop/personal/km_tag/src/index.js",[],"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/ConfirmationModal.js",[],"/home/vitor/Desktop/personal/km_tag/src/helper_functions/fileHandling.js",[],"/home/vitor/Desktop/personal/km_tag/src/components/Button.js",[],["87","88"],"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/TagsPanel.js",[],"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/BibInput.js",["89"],"import { useContext, useEffect, useMemo } from 'react'\nimport CurrentImage from '../../contexts/CurrentImage'\nimport Images from '../../contexts/Images'\nimport TextField from '@material-ui/core/TextField'\nimport Autocomplete from '@material-ui/lab/Autocomplete'\nimport { useState } from 'react'\nimport styled from 'styled-components'\n\nexport default function BibInput({ picturesList }) {\n  const [value, setValue] = useState('')\n  const [clock, setClock] = useState(true)\n  const { galeries } = useContext(Images)\n  const [isDisabled, setIsDisabled] = useState(true)\n  const [tabCallsNext, setTabCallsNext] = useState(false)\n\n  const {\n    currentImage,\n    setCurrentImage,\n    currentIndex,\n    setCurrentIndex\n  } = useContext(CurrentImage)\n  const { lastTag, setLastTag, tags, setTags } = useContext(Images)\n\n  function addTag(value) {\n    if (tags[currentImage].includes(value)) {\n      setValue('')\n      return\n    }\n    if (value !== '') {\n      tags[currentImage].push(value)\n      setTags({ ...tags })\n    } else {\n      if (tags[currentImage].length > 0) setLastTag([...tags[currentImage]])\n      next(currentIndex, picturesList.length - 1)\n    }\n    setValue('')\n  }\n\n  useEffect(() => {\n    if (picturesList?.length) {\n      setIsDisabled(false)\n    }\n  }, [picturesList])\n\n  const okTime = useMemo(() => {\n    return Date.now()\n  }, [clock])\n\n  function handleKeyDown(e) {\n    switch (e.key) {\n      case 'ArrowRight': {\n        e.preventDefault()\n        if (e.repeat) {\n          const timeAtRepeat = Date.now()\n          if (timeAtRepeat - okTime > 100) {\n            next(currentIndex, picturesList.length - 1)\n            setClock(!clock)\n          }\n          return\n        }\n\n        next(currentIndex, picturesList.length - 1)\n        break\n      }\n      case 'ArrowLeft': {\n        e.preventDefault()\n        if (e.repeat) {\n          const timeAtRepeat = Date.now()\n          if (timeAtRepeat - okTime > 100) {\n            previous(currentIndex, picturesList.length - 1)\n            setClock(!clock)\n          }\n          return\n        }\n\n        previous(currentIndex, picturesList.length - 1)\n        break\n      }\n      case 'Enter': {\n        if (isDisabled) return\n        if (e.repeat) return\n        const node = document.querySelector('#input-box')\n        const isBoxOpen = !!node.getAttribute('aria-activedescendant')\n        if (isBoxOpen) return\n        if (value === '' || !/[^0-9]/.test(value)) return addTag(value)\n        if (galeries.map(galery => galery.code).includes(value)) addTag(value)\n        else {\n          node.style.outline = '2px solid red'\n          setTimeout(() => {\n            node.style.outline = 'none'\n          }, 300)\n        }\n        break\n      }\n      case ' ': {\n        if (!/[^0-9]/.test(value)) e.preventDefault()\n        if (lastTag.length !== 0 && value === '') {\n          tags[currentImage] = [...lastTag]\n          setTags({ ...tags })\n          next(currentIndex, picturesList.length - 1)\n        }\n        break\n      }\n      case '-': {\n        e.preventDefault()\n        tags[currentImage].pop()\n        setTags({ ...tags })\n        break\n      }\n      case 'Tab': {\n        e.preventDefault()\n        const galery = galeries.find(\n          galery => galery.tabCode === e.target.value\n        )\n        if (galery) {\n          addTag(galery.code)\n          if(tabCallsNext) {\n            setLastTag(tags[currentImage]);\n            next(currentIndex, picturesList.length - 1)\n            console.log(\"banana\");\n          }\n        } else {\n          const node = document.querySelector('#input-box')\n          node.style.outline = '2px solid red'\n          setTimeout(() => {\n            node.style.outline = 'none'\n          }, 300)\n        }\n        break\n      }\n      default: {\n        break\n      }\n    }\n  }\n\n  function next(i, len) {\n    if (i === len) return\n    setCurrentIndex(currentIndex + 1)\n    setCurrentImage(picturesList[currentIndex + 1])\n  }\n\n  function previous(i, len) {\n    if (i === 0) return\n    setCurrentIndex(currentIndex - 1)\n    setCurrentImage(picturesList[currentIndex - 1])\n  }\n\n  const options = /[^0-9]/.test(value)\n    ? galeries.filter(galery => galery.isEnabled).map(galery => galery.display)\n    : []\n\n  return (\n    <>\n      <Autocomplete\n        className=\"bib-input-box\"\n        id=\"input-box\"\n        freeSolo\n        autoHighlight={true}\n        disableClearable\n        options={options}\n        inputValue={value}\n        onInputChange={(e, val) => {\n          if (isDisabled) return\n          if (!e) return\n          if (e.type === 'change') setValue(val)\n          if (e.type === 'click') {\n            const galery = galeries.find(galery => galery.display === val)\n            addTag(galery.code)\n          }\n          if (e.key === 'Enter') {\n            const galeryValue = galeries.find(galery => galery.code === value)\n            if (galeryValue) return addTag(galeryValue.code)\n            const galery = galeries.find(galery => galery.display === val)\n            addTag(galery.code)\n          }\n        }}\n        onKeyDown={e => handleKeyDown(e)}\n        renderInput={params => (\n          <TextField\n            disabled={isDisabled}\n            focused={!isDisabled}\n            {...params}\n            label=\"bib or galery\"\n            margin=\"dense\"\n            variant=\"standard\"\n          />\n        )}\n      />\n      <TabBehaviours\n        tabCallsNext={tabCallsNext}\n        setTabCallsNext={setTabCallsNext}\n      />\n    </>\n  )\n}\n\nfunction TabBehaviours({ tabCallsNext, setTabCallsNext }) {\n  return (\n    <TabWrapper>\n      <label style={{ fontSize: '12px' }} htmlFor=\"tabSkipper\">\n        Tab calls next\n      </label>\n      <input\n        onChange={() => {\n          setTabCallsNext(!tabCallsNext)\n        }}\n        checked={tabCallsNext}\n        type=\"checkbox\"\n      />\n    </TabWrapper>\n  )\n}\n\nconst TabWrapper = styled.div`\n  gap: 5px;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  justify-content: flex-end;\n`\n","/home/vitor/Desktop/personal/km_tag/src/styles/GlobalStyles.js",[],"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/BibList.js",[],"/home/vitor/Desktop/personal/km_tag/src/contexts/CurrentImage.js",[],["90","91"],"/home/vitor/Desktop/personal/km_tag/src/contexts/Images.js",[],"/home/vitor/Desktop/personal/km_tag/src/defaultGaleries.js",[],"/home/vitor/Desktop/personal/km_tag/src/components/TagsPanel/GalleriesModal.js",["92"],{"ruleId":"93","severity":1,"message":"94","line":89,"column":5,"nodeType":"95","endLine":89,"endColumn":11,"suggestions":"96"},{"ruleId":"93","severity":1,"message":"97","line":99,"column":5,"nodeType":"95","endLine":99,"endColumn":17,"suggestions":"98"},{"ruleId":"99","replacedBy":"100"},{"ruleId":"101","replacedBy":"102"},{"ruleId":"103","severity":1,"message":"104","line":5,"column":98,"nodeType":"105","messageId":"106","endLine":5,"endColumn":108},{"ruleId":"99","replacedBy":"107"},{"ruleId":"101","replacedBy":"108"},{"ruleId":"99","replacedBy":"109"},{"ruleId":"101","replacedBy":"110"},{"ruleId":"99","replacedBy":"111"},{"ruleId":"101","replacedBy":"112"},{"ruleId":"93","severity":1,"message":"113","line":47,"column":6,"nodeType":"95","endLine":47,"endColumn":13,"suggestions":"114"},{"ruleId":"99","replacedBy":"115"},{"ruleId":"101","replacedBy":"116"},{"ruleId":"103","severity":1,"message":"117","line":12,"column":21,"nodeType":"105","messageId":"106","endLine":12,"endColumn":32},"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'inputCount'. Either include it or remove the dependency array. You can also do a functional update 'setInputCount(i => ...)' if you only need 'inputCount' in the 'setInputCount' call.","ArrayExpression",["118"],"React Hook useEffect has missing dependencies: 'CSVFile' and 'saveToFile'. Either include them or remove the dependency array. If 'saveToFile' changes too often, find the parent component that defines it and wrap that definition in useCallback.",["119"],"no-native-reassign",["120"],"no-negated-in-lhs",["121"],"no-unused-vars","'tagsString' is assigned a value but never used.","Identifier","unusedVar",["120"],["121"],["120"],["121"],["120"],["121"],"React Hook useMemo has an unnecessary dependency: 'clock'. Either exclude it or remove the dependency array.",["122"],["120"],["121"],"'setGaleries' is assigned a value but never used.",{"desc":"123","fix":"124"},{"desc":"125","fix":"126"},"no-global-assign","no-unsafe-negation",{"desc":"127","fix":"128"},"Update the dependencies array to be: [inputCount, tags]",{"range":"129","text":"130"},"Update the dependencies array to be: [CSVFile, inputCount, saveToFile]",{"range":"131","text":"132"},"Update the dependencies array to be: []",{"range":"133","text":"134"},[3121,3127],"[inputCount, tags]",[3373,3385],"[CSVFile, inputCount, saveToFile]",[1347,1354],"[]"]